package com.kbstar.mbc.fc.foundation.bzcrudbus.exception;


public class ErrMsgFilter {
    private String errmsg="";
    public ErrMsgFilter(String msg) {
        this.errmsg = msg;
    }

    public String getSQLExceptionCode(){
        int Sqlindex=0;
        String sqlerr = "java.sql.SQLException:";
        String sqlerr2 = "DuplicateKeyException:";
                
        Sqlindex = this.errmsg.indexOf(sqlerr);
        String tmpMsg = this.errmsg.substring(Sqlindex+sqlerr.length());
        tmpMsg = tmpMsg.substring(0,tmpMsg.indexOf(":"));
        tmpMsg = tmpMsg.substring(tmpMsg.indexOf("-")+1);
        
        Sqlindex = 0;

        if ( (Sqlindex = this.errmsg.indexOf(sqlerr2)) > 0 ) {
        	tmpMsg = this.errmsg.substring(Sqlindex+sqlerr2.length());
        	tmpMsg = tmpMsg.substring(0,tmpMsg.indexOf(":"));
            tmpMsg = tmpMsg.substring(tmpMsg.indexOf("-")+1);
        }
        return tmpMsg;
    }

    public String getSQLExceptionMsg(){
        int Sqlindex=0;
        String sqlerr = "java.sql.SQLException:";
        String sqlerr2 = "DuplicateKeyException:";
        
        Sqlindex = this.errmsg.indexOf(sqlerr);
        String tmpMsg = this.errmsg.substring(Sqlindex+sqlerr.length());
        
        Sqlindex = 0;
        
        if ( (Sqlindex = this.errmsg.indexOf(sqlerr2)) > 0 ) {
        	tmpMsg = this.errmsg.substring(Sqlindex+sqlerr2.length());
        }

        return tmpMsg;
    }

//nested exception is: java.sql.SQLException: ORA-00001: unique constraint (TEST.PK_S3ORDERM) violated;
    public String getExceptionName(){
        int Sqlindex=0;
        String sqlerr = "is: ";

        Sqlindex = this.errmsg.lastIndexOf(sqlerr);
        String tmpMsg = this.errmsg.substring(Sqlindex+sqlerr.length());
        tmpMsg = tmpMsg.substring(0,tmpMsg.indexOf(":"));

        return tmpMsg;
    }

}