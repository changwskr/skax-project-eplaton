package com.kbstar.mbc.dc.usermgtdc;

import java.util.List;

import com.kbstar.ksa.das.PersistenceException;
import com.kbstar.ksa.das.RecordNotFoundException;
import com.kbstar.ksa.das.ibatis.SqlMapper;
import com.kbstar.ksa.exception.BusinessException;
import com.kbstar.ksa.exception.FrameworkException;
import com.kbstar.ksa.logger.IKesaLogger;
import com.kbstar.ksa.logger.KesaLogHelper;
import com.kbstar.ksa.util.ObjectUtil;
import com.kbstar.mbc.dc.usermgtdc.dto.UserDDTO;


public class DCUser implements IDCUser {
	
	protected IKesaLogger logger = KesaLogHelper.getBiz();
	
	public List<User> getListUser(UserDDTO userDDTO) throws BusinessException{
		
		List<User> UserList = null;
		
		try {
			UserList = SqlMapper.getSqlMapClient().queryForList("user.getListUser", userDDTO);
			
		} 
		catch (PersistenceException e) {
			e.printStackTrace();
		} 
		catch (FrameworkException e) {
			e.printStackTrace();
		}
		
		return ObjectUtil.copyForList(User.class, UserList);
	
	}
	
	public void crudUser(UserDDTO[] userDDTOs) throws BusinessException{
		
		logger.debug("crudUser 메소드로 들어왔음");
		
		String crud = null;
		logger.debug("userDDTO 길이" + userDDTOs.length);
		try {
								
			for(int i = 0 ; i < userDDTOs.length; i++){
				
				crud = (userDDTOs[i].getCrud()).toUpperCase();
				logger.debug("crud = " + crud);
				
				
				if(crud.equals("C")){
					SqlMapper.getSqlMapClient().insert("user.insertUser", userDDTOs[i]);
				}
				else if(crud.equals("U")){
					SqlMapper.getSqlMapClient().update("user.updateUser", userDDTOs[i]);
				}
				else if(crud.equals("D")){
					SqlMapper.getSqlMapClient().update("user.deleteUser",  userDDTOs[i]);
				}
			}
		} 
		catch (RecordNotFoundException e) {
			throw new BusinessException("B0000001", "processCode", e);
		} 
		catch (PersistenceException e) {
			throw new BusinessException("B0000002", "processCode", e);
		} 
		catch (FrameworkException e) {
			throw new BusinessException("B0000002", "processCode", e);
		}
	}

}
